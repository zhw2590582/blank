!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SimpleFS=t():e.SimpleFS=t()}("undefined"!=typeof self?self:this,function(){return function(){var r={757:function(e,t,n){e.exports=n(666)},666:function(e){var t=function(a){"use strict";var s,e=Object.prototype,l=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},i=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",r=t.toStringTag||"@@toStringTag";function o(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,o=Object.create(i.prototype),a=new S(r||[]);return o._invoke=function(o,a,u){var s=c;return function(e,t){if(s===p)throw new Error("Generator is already running");if(s===d){if("throw"===e)throw t;return K()}for(u.method=e,u.arg=t;;){var n=u.delegate;if(n){var r=O(n,u);if(r){if(r===y)continue;return r}}if("next"===u.method)u.sent=u._sent=u.arg;else if("throw"===u.method){if(s===c)throw s=d,u.arg;u.dispatchException(u.arg)}else"return"===u.method&&u.abrupt("return",u.arg);s=p;var i=f(o,a,u);if("normal"===i.type){if(s=u.done?d:h,i.arg===y)continue;return{value:i.arg,done:u.done}}"throw"===i.type&&(s=d,u.method="throw",u.arg=i.arg)}}}(e,n,a),o}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}a.wrap=u;var c="suspendedStart",h="suspendedYield",p="executing",d="completed",y={};function v(){}function m(){}function g(){}var b={};b[i]=function(){return this};var w=Object.getPrototypeOf,_=w&&w(w(A([])));_&&_!==e&&l.call(_,i)&&(b=_);var x=g.prototype=v.prototype=Object.create(b);function k(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function E(s,c){var t;this._invoke=function(n,r){function e(){return new c(function(e,t){!function t(e,n,r,i){var o=f(s[e],s,n);if("throw"!==o.type){var a=o.arg,u=a.value;return u&&"object"==typeof u&&l.call(u,"__await")?c.resolve(u.__await).then(function(e){t("next",e,r,i)},function(e){t("throw",e,r,i)}):c.resolve(u).then(function(e){a.value=e,r(a)},function(e){return t("throw",e,r,i)})}i(o.arg)}(n,r,e,t)})}return t=t?t.then(e,e):e()}}function O(e,t){var n=e.iterator[t.method];if(n===s){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=s,O(e,t),"throw"===t.method))return y;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var r=f(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,y;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=s),t.delegate=null,y):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,y)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function A(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(l.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=s,e.done=!0,e};return r.next=r}}return{next:K}}function K(){return{value:s,done:!0}}return m.prototype=x.constructor=g,(g.constructor=m).displayName=o(g,r,"GeneratorFunction"),a.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,o(e,r,"GeneratorFunction")),e.prototype=Object.create(x),e},a.awrap=function(e){return{__await:e}},k(E.prototype),E.prototype[n]=function(){return this},a.AsyncIterator=E,a.async=function(e,t,n,r,i){void 0===i&&(i=Promise);var o=new E(u(e,t,n,r),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},k(x),o(x,r,"Generator"),x[i]=function(){return this},x.toString=function(){return"[object Generator]"},a.keys=function(n){var r=[];for(var e in n)r.push(e);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=A,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(j),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=s)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function e(e,t){return o.type="throw",o.arg=n,r.next=e,t&&(r.method="next",r.arg=s),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=l.call(i,"catchLoc"),u=l.call(i,"finallyLoc");if(a&&u){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&l.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),j(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;j(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=s),y}},a}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}},i={};function pr(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return r[e](n,n.exports,pr),n.exports}pr.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return pr.d(t,{a:t}),t},pr.d=function(e,t){for(var n in t)pr.o(t,n)&&!pr.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},pr.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var dr={};return function(){"use strict";function s(e,t,n,r,i,o,a){try{var u=e[o](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function y(u){return function(){var e=this,a=arguments;return new Promise(function(t,n){var r=u.apply(e,a);function i(e){s(r,t,n,i,o,"next",e)}function o(e){s(r,t,n,i,o,"throw",e)}i(void 0)})}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}pr.d(dr,{default:function(){return hr}});function g(e,t,n,r,i,o,a,u){v(this,g);var s=Date.now();this.path=e,this.mode=t||x,this.size=n||0,this.flags=r||{},this.atime=o||s,this.ctime=a||s,this.mtime=u||s,this.blksize=void 0,this.nblocks=1,this.data=i}var e=pr(757),b=pr.n(e),w=function(){function t(e){if(v(this,t),"string"==typeof e)this.path=e;else{if(!(e instanceof t))throw new Error("It's neither Path nor string");this.path=e.path}}return m(t,[{key:"normalize",value:function(){return"\\"===this.path||"/"===this.path?this.path="/":this.path=this.path.split(/[/\\]+/).join("/"),this}},{key:"basename",get:function(){var e=this.path.match(/(\/)?(\w+\.(\S+))/);if(!(e.size<2))return e[2]}},{key:"extension",get:function(){var e=this.path.match(/(\/)?(\w+\.(\S+))/);if(!(e.size<3))return e[3]}},{key:"parent",get:function(){var e=this.path.split("/");return e.pop(),new t(e.join("/")).normalize()}},{key:"isRoot",get:function(){return""===this.path}}]),t}(),_="DIR",x="FILE",t="SYMBOLIC_LINK",k=function(){function n(e,t){v(this,n),this.node=e,this.dev=t,this.size=e.size,this.atime=e.atime,this.ctime=e.ctime,this.mtime=e.mtime,this.type=e.mode}return m(n,[{key:"isFile",value:function(){return this.type===x}},{key:"isDirectory",value:function(){return this.type===_}},{key:"isSymbolicLink",value:function(){return this.type===t}},{key:"isSocket",value:function(){return!1}},{key:"isFIFO",value:function(){return!1}},{key:"isCharacterDevice",value:function(){return!1}},{key:"isBlockDevice",value:function(){return!1}}]),n}();function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=a(r);if(i){var n=a(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return o(this,e)}}var E=function(){l(i,k);var r=u(i);function i(e,t){var n;return v(this,i),(n=r.call(this,e,t)).path=t,n.assign(e),n}return m(i,[{key:"assign",value:function(t){var n=this;Object.keys(t).forEach(function(e){n[e]=t[e]})}}]),i}(),O=function(){return(O=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function P(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,u=o.length;a<u;a++,i++)r[i]=o[a];return r}var j=Object.keys,p=Array.isArray,h="undefined"!=typeof self?self:"undefined"!=typeof window?window:global;function c(t,n){return"object"!=typeof n||j(n).forEach(function(e){t[e]=n[e]}),t}"undefined"==typeof Promise||h.Promise||(h.Promise=Promise);var f=Object.getPrototypeOf,d={}.hasOwnProperty;function S(e,t){return d.call(e,t)}function A(t,n){"function"==typeof n&&(n=n(f(t))),j(n).forEach(function(e){I(t,e,n[e])})}var K=Object.defineProperty;function I(e,t,n,r){K(e,t,c(n&&S(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function C(t){return{from:function(e){return t.prototype=Object.create(e.prototype),I(t.prototype,"constructor",t),{extend:A.bind(null,t.prototype)}}}}var R=Object.getOwnPropertyDescriptor;function B(e,t){var n;return R(e,t)||(n=f(e))&&B(n,t)}var T=[].slice;function D(e,t,n){return T.call(e,t,n)}function F(e,t){return t(e)}function N(e){if(!e)throw new Error("Assertion Failed")}function q(e){h.setImmediate?setImmediate(e):setTimeout(e,0)}function M(e,i){return e.reduce(function(e,t,n){var r=i(t,n);return r&&(e[r[0]]=r[1]),e},{})}function L(e,t){if(S(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=L(e,t[r]);n.push(o)}return n}var a=t.indexOf(".");if(-1!==a){var u=e[t.substr(0,a)];return void 0===u?void 0:L(u,t.substr(a+1))}}function z(e,t,n){if(e&&void 0!==t&&!("isFrozen"in Object&&Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){N("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)z(e,t[r],n[r])}else{var o=t.indexOf(".");if(-1!==o){var a=t.substr(0,o),u=t.substr(o+1);if(""===u)void 0===n?p(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=n;else{var s=e[a];z(s=s||(e[a]={}),u,n)}}else void 0===n?p(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function U(t,e){"string"==typeof e?z(t,e,void 0):"length"in e&&[].map.call(e,function(e){z(t,e,void 0)})}function V(e){var t={};for(var n in e)S(e,n)&&(t[n]=e[n]);return t}var G=[].concat;function W(e){return G.apply([],e)}var Y="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(W([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(e){return h[e]}),H=Y.map(function(e){return h[e]}),Q=M(Y,function(e){return[e,!0]});function X(e){if(!e||"object"!=typeof e)return e;var t;if(p(e)){t=[];for(var n=0,r=e.length;n<r;++n)t.push(X(e[n]))}else if(0<=H.indexOf(e.constructor))t=e;else for(var i in t=e.constructor?Object.create(e.constructor.prototype):{},e)S(e,i)&&(t[i]=X(e[i]));return t}var $={}.toString;function J(e){return $.call(e).slice(8,-1)}var Z=function(e,t){return"Array"===t?""+e.map(function(e){return Z(e,J(e))}):"ArrayBuffer"===t?""+new Uint8Array(e):"Date"===t?e.getTime():ArrayBuffer.isView(e)?""+new Uint8Array(e.buffer):e};function ee(o,a,u,s){return u=u||{},s=s||"",j(o).forEach(function(e){if(S(a,e)){var t=o[e],n=a[e];if("object"==typeof t&&"object"==typeof n&&t&&n){var r=J(t),i=J(n);r===i?Q[r]?Z(t,r)!==Z(n,i)&&(u[s+e]=a[e]):ee(t,n,u,s+e+"."):u[s+e]=a[e]}else t!==n&&(u[s+e]=a[e])}else u[s+e]=void 0}),j(a).forEach(function(e){S(o,e)||(u[s+e]=a[e])}),u}var te="undefined"!=typeof Symbol&&Symbol.iterator,ne=te?function(e){var t;return null!=e&&(t=e[te])&&t.apply(e)}:function(){return null},re={};function ie(e){var t,n,r,i;if(1===arguments.length){if(p(e))return e.slice();if(this===re&&"string"==typeof e)return[e];if(i=ne(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"!=typeof(t=e.length))return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var oe="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},ae="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ue(e,t){ae=e,se=t}var se=function(){return!0},ce=!new Error("").stack;function le(){if(ce)try{throw new Error}catch(e){return e}return new Error}function fe(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(se).map(function(e){return"\n"+e}).join("")):""}var he=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],pe=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(he),de={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function ye(e,t){this._e=le(),this.name=e,this.message=t}function ve(e,t){return e+". Errors: "+Object.keys(t).map(function(e){return t[e].toString()}).filter(function(e,t,n){return n.indexOf(e)===t}).join("\n")}function me(e,t,n,r){this._e=le(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=ve(e,t)}function ge(e,t){this._e=le(),this.name="BulkError",this.failures=t,this.message=ve(e,t)}C(ye).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+fe(this._e,2))}},toString:function(){return this.name+": "+this.message}}),C(me).from(ye),C(ge).from(ye);var be=pe.reduce(function(e,t){return e[t]=t+"Error",e},{}),we=ye,_e=pe.reduce(function(e,n){var r=n+"Error";function t(e,t){this._e=le(),this.name=r,e?"string"==typeof e?(this.message=e+(t?"\n "+t:""),this.inner=t||null):"object"==typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=de[n]||r,this.inner=null)}return C(t).from(we),e[n]=t,e},{});_e.Syntax=SyntaxError,_e.Type=TypeError,_e.Range=RangeError;var xe=he.reduce(function(e,t){return e[t+"Error"]=_e[t],e},{});var ke=pe.reduce(function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=_e[t]),e},{});function Ee(){}function Oe(e){return e}function Pe(t,n){return null==t||t===Oe?n:function(e){return n(t(e))}}function je(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Se(i,o){return i===Ee?o:function(){var e=i.apply(this,arguments);void 0!==e&&(arguments[0]=e);var t=this.onsuccess,n=this.onerror;this.onsuccess=null,this.onerror=null;var r=o.apply(this,arguments);return t&&(this.onsuccess=this.onsuccess?je(t,this.onsuccess):t),n&&(this.onerror=this.onerror?je(n,this.onerror):n),void 0!==r?r:e}}function Ae(n,r){return n===Ee?r:function(){n.apply(this,arguments);var e=this.onsuccess,t=this.onerror;this.onsuccess=this.onerror=null,r.apply(this,arguments),e&&(this.onsuccess=this.onsuccess?je(e,this.onsuccess):e),t&&(this.onerror=this.onerror?je(t,this.onerror):t)}}function Ke(o,a){return o===Ee?a:function(e){var t=o.apply(this,arguments);c(e,t);var n=this.onsuccess,r=this.onerror;this.onsuccess=null,this.onerror=null;var i=a.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?je(n,this.onsuccess):n),r&&(this.onerror=this.onerror?je(r,this.onerror):r),void 0===t?void 0===i?void 0:i:c(t,i)}}function Ie(e,t){return e===Ee?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function Ce(i,o){return i===Ee?o:function(){var e=i.apply(this,arguments);if(e&&"function"==typeof e.then){for(var t=this,n=arguments.length,r=new Array(n);n--;)r[n]=arguments[n];return e.then(function(){return o.apply(t,r)})}return o.apply(this,arguments)}}ke.ModifyError=me,ke.DexieError=ye,ke.BulkError=ge;var Re={},Be=100,Te=100,De="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,e.__proto__,e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,t.__proto__,e]}(),Fe=De[0],Ne=De[1],qe=De[2],Me=Ne&&Ne.then,Le=Fe&&Fe.constructor,ze=!!qe,Ue=!1,Ve=qe?function(){qe.then(ft)}:h.setImmediate?setImmediate.bind(null,ft):h.MutationObserver?function(){var e=document.createElement("div");new MutationObserver(function(){ft(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(ft,0)},Ge=function(e,t){et.push([e,t]),Ye&&(Ve(),Ye=!1)},We=!0,Ye=!0,He=[],Qe=[],Xe=null,$e=Oe,Je={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Tt,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(e){try{Tt(e[0],e[1])}catch(e){}})}},Ze=Je,et=[],tt=0,nt=[];function rt(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Ee,this._lib=!1;var t=this._PSD=Ze;if(ae&&(this._stackHolder=le(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==Re)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&at(this,this._value))}this._state=null,this._value=null,++t.ref,function t(r,e){try{e(function(n){if(null===r._state){if(n===r)throw new TypeError("A promise cannot be resolved with itself.");var e=r._lib&&ht();n&&"function"==typeof n.then?t(r,function(e,t){n instanceof rt?n._then(e,t):n.then(e,t)}):(r._state=!0,r._value=n,ut(r)),e&&pt()}},at.bind(null,r))}catch(e){at(r,e)}}(this,e)}var it={get:function(){var u=Ze,t=_t;function e(n,r){var i=this,o=!u.global&&(u!==Ze||t!==_t),a=o&&!Ot(),e=new rt(function(e,t){st(i,new ot(Ct(n,u,o,a),Ct(r,u,o,a),e,t,u))});return ae&&lt(e,this),e}return e.prototype=Re,e},set:function(e){I(this,"then",e&&e.prototype===Re?it:{get:function(){return e},set:it.set})}};function ot(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function at(t,n){if(Qe.push(n),null===t._state){var e=t._lib&&ht();n=$e(n),t._state=!1,t._value=n,ae&&null!==n&&"object"==typeof n&&!n._promise&&function(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}(function(){var e=B(n,"stack");n._promise=t,I(n,"stack",{get:function(){return Ue?e&&(e.get?e.get.apply(n):e.value):t.stack}})}),function(t){He.some(function(e){return e._value===t._value})||He.push(t)}(t),ut(t),e&&pt()}}function ut(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)st(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===tt&&(++tt,Ge(function(){0==--tt&&dt()},[]))}function st(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++tt,Ge(ct,[n,e,t])}else e._listeners.push(t)}function ct(e,t,n){try{var r,i=(Xe=t)._value;t._state?r=e(i):(Qe.length&&(Qe=[]),r=e(i),-1===Qe.indexOf(i)&&function(e){var t=He.length;for(;t;)if(He[--t]._value===e._value)return He.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{Xe=null,0==--tt&&dt(),--n.psd.ref||n.psd.finalize()}}function lt(e,t){var n=t?t._numPrev+1:0;n<Be&&(e._prev=t,e._numPrev=n)}function ft(){ht()&&pt()}function ht(){var e=We;return Ye=We=!1,e}function pt(){var e,t,n;do{for(;0<et.length;)for(e=et,et=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(0<et.length);Ye=We=!0}function dt(){var e=He;He=[],e.forEach(function(e){e._PSD.onunhandled.call(null,e._value,e)});for(var t=nt.slice(0),n=t.length;n;)t[--n]()}function yt(e){return new rt(Re,!1,e)}function vt(n,r){var i=Ze;return function(){var e=ht(),t=Ze;try{return St(i,!0),n.apply(this,arguments)}catch(e){r&&r(e)}finally{St(t,!1),e&&pt()}}}A(rt.prototype,{then:it,_then:function(e,t){st(this,new ot(null,null,e,t,Ze))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=e,n=arguments[1];return"function"==typeof t?this.then(null,function(e){return e instanceof t?n(e):yt(e)}):this.then(null,function(e){return e&&e.name===t?n(e):yt(e)})},finally:function(t){return this.then(function(e){return t(),e},function(e){return t(),yt(e)})},stack:{get:function(){if(this._stack)return this._stack;try{Ue=!0;var e=function e(t,n,r){if(n.length===r)return n;var i="";if(!1===t._state){var o,a,u=t._value;null!=u?(o=u.name||"Error",a=u.message||u,i=fe(u,0)):(o=u,a=""),n.push(o+(a?": "+a:"")+i)}ae&&((i=fe(t._stackHolder,2))&&-1===n.indexOf(i)&&n.push(i),t._prev&&e(t._prev,n,r));return n}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{Ue=!1}}},timeout:function(r,i){var o=this;return r<1/0?new rt(function(e,t){var n=setTimeout(function(){return t(new _e.Timeout(i))},r);o.then(e,t).finally(clearTimeout.bind(null,n))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&I(rt.prototype,Symbol.toStringTag,"Dexie.Promise"),Je.env=At(),A(rt,{all:function(){var o=ie.apply(null,arguments).map(Pt);return new rt(function(n,r){0===o.length&&n([]);var i=o.length;o.forEach(function(e,t){return rt.resolve(e).then(function(e){o[t]=e,--i||n(o)},r)})})},resolve:function(n){if(n instanceof rt)return n;if(n&&"function"==typeof n.then)return new rt(function(e,t){n.then(e,t)});var e=new rt(Re,!0,n);return lt(e,Xe),e},reject:yt,race:function(){var e=ie.apply(null,arguments).map(Pt);return new rt(function(t,n){e.map(function(e){return rt.resolve(e).then(t,n)})})},PSD:{get:function(){return Ze},set:function(e){return Ze=e}},totalEchoes:{get:function(){return _t}},newPSD:kt,usePSD:Kt,scheduler:{get:function(){return Ge},set:function(e){Ge=e}},rejectionMapper:{get:function(){return $e},set:function(e){$e=e}},follow:function(r,n){return new rt(function(e,t){return kt(function(t,n){var e=Ze;e.unhandleds=[],e.onunhandled=n,e.finalize=je(function(){var e=this;!function(t){nt.push(function e(){t(),nt.splice(nt.indexOf(e),1)}),++tt,Ge(function(){0==--tt&&dt()},[])}(function(){0===e.unhandleds.length?t():n(e.unhandleds[0])})},e.finalize),r()},n,e,t)})}}),Le&&(Le.allSettled&&I(rt,"allSettled",function(){var e=ie.apply(null,arguments).map(Pt);return new rt(function(n){0===e.length&&n([]);var r=e.length,i=new Array(r);e.forEach(function(e,t){return rt.resolve(e).then(function(e){return i[t]={status:"fulfilled",value:e}},function(e){return i[t]={status:"rejected",reason:e}}).then(function(){return--r||n(i)})})})}),Le.any&&"undefined"!=typeof AggregateError&&I(rt,"any",function(){var e=ie.apply(null,arguments).map(Pt);return new rt(function(n,r){0===e.length&&r(new AggregateError([]));var i=e.length,o=new Array(i);e.forEach(function(e,t){return rt.resolve(e).then(function(e){return n(e)},function(e){o[t]=e,--i||r(new AggregateError(o))})})})}));var mt={awaits:0,echoes:0,id:0},gt=0,bt=[],wt=0,_t=0,xt=0;function kt(e,t,n,r){var i=Ze,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++xt;var a=Je.env;o.env=ze?{Promise:rt,PromiseProp:{value:rt,configurable:!0,writable:!0},all:rt.all,race:rt.race,allSettled:rt.allSettled,any:rt.any,resolve:rt.resolve,reject:rt.reject,nthen:Rt(a.nthen,o),gthen:Rt(a.gthen,o)}:{},t&&c(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=Kt(o,e,n,r);return 0===o.ref&&o.finalize(),u}function Et(){return mt.id||(mt.id=++gt),++mt.awaits,mt.echoes+=Te,mt.id}function Ot(){return!!mt.awaits&&(0==--mt.awaits&&(mt.id=0),mt.echoes=mt.awaits*Te,!0)}function Pt(e){return mt.echoes&&e&&e.constructor===Le?(Et(),e.then(function(e){return Ot(),e},function(e){return Ot(),Dt(e)})):e}function jt(){var e=bt[bt.length-1];bt.pop(),St(e,!1)}function St(e,t){var n=Ze;if((t?!mt.echoes||wt++&&e===Ze:!wt||--wt&&e===Ze)||It(t?function(e){++_t,mt.echoes&&0!=--mt.echoes||(mt.echoes=mt.id=0),bt.push(Ze),St(e,!0)}.bind(null,e):jt),e!==Ze&&(Ze=e,n===Je&&(Je.env=At()),ze)){var r=Je.env.Promise,i=e.env;Ne.then=i.nthen,r.prototype.then=i.gthen,(n.global||e.global)&&(Object.defineProperty(h,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function At(){var e=h.Promise;return ze?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(h,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:Ne.then,gthen:e.prototype.then}:{}}function Kt(e,t,n,r,i){var o=Ze;try{return St(e,!0),t(n,r,i)}finally{St(o,!1)}}function It(e){Me.call(Fe,e)}function Ct(t,n,r,i){return"function"!=typeof t?t:function(){var e=Ze;r&&Et(),St(n,!0);try{return t.apply(this,arguments)}finally{St(e,!1),i&&It(Ot)}}}function Rt(n,r){return function(e,t){return n.call(this,Ct(e,r),Ct(t,r))}}-1===(""+Me).indexOf("[native code]")&&(Et=Ot=Ee);var Bt="unhandledrejection";function Tt(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(!1!==n)try{var r,i={promise:t,reason:e};if(h.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(Bt,!0,!0),c(r,i)):h.CustomEvent&&c(r=new CustomEvent(Bt,{detail:i}),i),r&&h.dispatchEvent&&(dispatchEvent(r),!h.PromiseRejectionEvent&&h.onunhandledrejection))try{h.onunhandledrejection(r)}catch(e){}ae&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch(e){}}var Dt=rt.reject;function Ft(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)}var Nt=String.fromCharCode(65535),qt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Mt="String expected.",Lt=[],zt="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Ut=zt,Vt=zt,Gt="__dbnames",Wt="readonly",Yt="readwrite";function Ht(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Qt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Xt(t){return function(e){return void 0===L(e,t)&&U(e=X(e),t),e}}var $t=(Jt.prototype._trans=function(e,r,t){var n=this._tx||Ze.trans,i=this.name;function o(e,t,n){if(!n.schema[i])throw new _e.NotFound("Table "+i+" not part of transaction");return r(n.idbtrans,n)}var a=ht();try{return n&&n.db===this.db?n===Ze.trans?n._promise(e,o,t):kt(function(){return n._promise(e,o,t)},{trans:n,transless:Ze.transless||Ze}):function e(t,n,r,i){if(t._state.openComplete||Ze.letThrough){var o=t._createTransaction(n,r,t._dbSchema);try{o.create()}catch(e){return Dt(e)}return o._promise(n,function(e,t){return kt(function(){return Ze.trans=o,i(e,t,o)})}).then(function(e){return o._completion.then(function(){return e})})}if(!t._state.isBeingOpened){if(!t._options.autoOpen)return Dt(new _e.DatabaseClosed);t.open().catch(Ee)}return t._state.dbReadyPromise.then(function(){return e(t,n,r,i)})}(this.db,e,[this.name],o)}finally{a&&pt()}},Jt.prototype.get=function(t,e){var n=this;return t&&t.constructor===Object?this.where(t).first(e):this._trans("readonly",function(e){return n.core.get({trans:e,key:t}).then(function(e){return n.hook.reading.fire(e)})}).then(e)},Jt.prototype.where=function(a){if("string"==typeof a)return new this.db.WhereClause(this,a);if(p(a))return new this.db.WhereClause(this,"["+a.join("+")+"]");var n=j(a);if(1===n.length)return this.where(n[0]).equals(a[n[0]]);var e=this.schema.indexes.concat(this.schema.primKey).filter(function(t){return t.compound&&n.every(function(e){return 0<=t.keyPath.indexOf(e)})&&t.keyPath.every(function(e){return 0<=n.indexOf(e)})})[0];if(e&&this.db._maxKey!==Nt)return this.where(e.name).equals(e.keyPath.map(function(e){return a[e]}));!e&&ae&&console.warn("The query "+JSON.stringify(a)+" on "+this.name+" would benefit of a compound index ["+n.join("+")+"]");var u=this.schema.idxByName,r=this.db._deps.indexedDB;function s(e,t){try{return 0===r.cmp(e,t)}catch(e){return!1}}var t=n.reduce(function(e,n){var t=e[0],r=e[1],i=u[n],o=a[n];return[t||i,t||!i?Ht(r,i&&i.multi?function(e){var t=L(e,n);return p(t)&&t.some(function(e){return s(o,e)})}:function(e){return s(o,L(e,n))}):r]},[null,null]),i=t[0],o=t[1];return i?this.where(i.name).equals(a[i.keyPath]).filter(o):e?this.filter(o):this.where(n).equals("")},Jt.prototype.filter=function(e){return this.toCollection().and(e)},Jt.prototype.count=function(e){return this.toCollection().count(e)},Jt.prototype.offset=function(e){return this.toCollection().offset(e)},Jt.prototype.limit=function(e){return this.toCollection().limit(e)},Jt.prototype.each=function(e){return this.toCollection().each(e)},Jt.prototype.toArray=function(e){return this.toCollection().toArray(e)},Jt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Jt.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,p(e)?"["+e.join("+")+"]":e))},Jt.prototype.reverse=function(){return this.toCollection().reverse()},Jt.prototype.mapToClass=function(r){function e(e){if(!e)return e;var t=Object.create(r.prototype);for(var n in e)if(S(e,n))try{t[n]=e[n]}catch(e){}return t}return this.schema.mappedClass=r,this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=e,this.hook("reading",e),r},Jt.prototype.defineClass=function(){return this.mapToClass(function(e){c(this,e)})},Jt.prototype.add=function(t,n){var r=this,e=this.schema.primKey,i=e.auto,o=e.keyPath,a=t;return o&&i&&(a=Xt(o)(t)),this._trans("readwrite",function(e){return r.core.mutate({trans:e,type:"add",keys:null!=n?[n]:null,values:[a]})}).then(function(e){return e.numFailures?rt.reject(e.failures[0]):e.lastResult}).then(function(e){if(o)try{z(t,o,e)}catch(e){}return e})},Jt.prototype.update=function(t,n){if("object"!=typeof n||p(n))throw new _e.InvalidArgument("Modifications must be an object.");if("object"!=typeof t||p(t))return this.where(":id").equals(t).modify(n);j(n).forEach(function(e){z(t,e,n[e])});var e=L(t,this.schema.primKey.keyPath);return void 0===e?Dt(new _e.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(n)},Jt.prototype.put=function(t,n){var r=this,e=this.schema.primKey,i=e.auto,o=e.keyPath,a=t;return o&&i&&(a=Xt(o)(t)),this._trans("readwrite",function(e){return r.core.mutate({trans:e,type:"put",values:[a],keys:null!=n?[n]:null})}).then(function(e){return e.numFailures?rt.reject(e.failures[0]):e.lastResult}).then(function(e){if(o)try{z(t,o,e)}catch(e){}return e})},Jt.prototype.delete=function(t){var n=this;return this._trans("readwrite",function(e){return n.core.mutate({trans:e,type:"delete",keys:[t]})}).then(function(e){return e.numFailures?rt.reject(e.failures[0]):void 0})},Jt.prototype.clear=function(){var t=this;return this._trans("readwrite",function(e){return t.core.mutate({trans:e,type:"deleteRange",range:Qt})}).then(function(e){return e.numFailures?rt.reject(e.failures[0]):void 0})},Jt.prototype.bulkGet=function(t){var n=this;return this._trans("readonly",function(e){return n.core.getMany({keys:t,trans:e}).then(function(e){return e.map(function(e){return n.hook.reading.fire(e)})})})},Jt.prototype.bulkAdd=function(a,e,t){var u=this,s=Array.isArray(e)?e:void 0,c=(t=t||(s?void 0:e))?t.allKeys:void 0;return this._trans("readwrite",function(e){var t=u.schema.primKey,n=t.auto,r=t.keyPath;if(r&&s)throw new _e.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==a.length)throw new _e.InvalidArgument("Arguments objects and keys must have the same length");var o=a.length,i=r&&n?a.map(Xt(r)):a;return u.core.mutate({trans:e,type:"add",keys:s,values:i,wantResults:c}).then(function(e){var t=e.numFailures,n=e.results,r=e.lastResult,i=e.failures;if(0===t)return c?n:r;throw new ge(u.name+".bulkAdd(): "+t+" of "+o+" operations failed",Object.keys(i).map(function(e){return i[e]}))})})},Jt.prototype.bulkPut=function(a,e,t){var u=this,s=Array.isArray(e)?e:void 0,c=(t=t||(s?void 0:e))?t.allKeys:void 0;return this._trans("readwrite",function(e){var t=u.schema.primKey,n=t.auto,r=t.keyPath;if(r&&s)throw new _e.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==a.length)throw new _e.InvalidArgument("Arguments objects and keys must have the same length");var o=a.length,i=r&&n?a.map(Xt(r)):a;return u.core.mutate({trans:e,type:"put",keys:s,values:i,wantResults:c}).then(function(e){var t=e.numFailures,n=e.results,r=e.lastResult,i=e.failures;if(0===t)return c?n:r;throw new ge(u.name+".bulkPut(): "+t+" of "+o+" operations failed",Object.keys(i).map(function(e){return i[e]}))})})},Jt.prototype.bulkDelete=function(t){var i=this,o=t.length;return this._trans("readwrite",function(e){return i.core.mutate({trans:e,type:"delete",keys:t})}).then(function(e){var t=e.numFailures,n=e.lastResult,r=e.failures;if(0===t)return n;throw new ge(i.name+".bulkDelete(): "+t+" of "+o+" operations failed",r)})},Jt);function Jt(){}function Zt(i){var o={},t=function(e,t){if(t){for(var n=arguments.length,r=new Array(n-1);--n;)r[n-1]=arguments[n];return o[e].subscribe.apply(null,r),i}if("string"==typeof e)return o[e]};t.addEventType=a;for(var e=1,n=arguments.length;e<n;++e)a(arguments[e]);return t;function a(e,n,r){if("object"==typeof e)return function(r){j(r).forEach(function(e){var t=r[e];if(p(t))a(e,r[e][0],r[e][1]);else{if("asap"!==t)throw new _e.InvalidArgument("Invalid event config");var n=a(e,Oe,function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];n.subscribers.forEach(function(e){q(function(){e.apply(null,t)})})})}})}(e);n=n||Ie;var i={subscribers:[],fire:r=r||Ee,subscribe:function(e){-1===i.subscribers.indexOf(e)&&(i.subscribers.push(e),i.fire=n(i.fire,e))},unsubscribe:function(t){i.subscribers=i.subscribers.filter(function(e){return e!==t}),i.fire=i.subscribers.reduce(n,r)}};return o[e]=t[e]=i,i}}function en(e,t){return C(t).from({prototype:e}),t}function tn(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function nn(e,t){e.filter=Ht(e.filter,t)}function rn(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Ht(r(),t())}:t,e.justLimit=n&&!r}function on(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new _e.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function an(e,t,n){var r=on(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function un(e,o,t,n){var a=e.replayFilter?Ht(e.filter,e.replayFilter()):e.filter;if(e.or){var u={},r=function(e,t,n){if(!a||a(t,n,function(e){return t.stop(e)},function(e){return t.fail(e)})){var r=t.primaryKey,i=""+r;"[object ArrayBuffer]"===i&&(i=""+new Uint8Array(r)),S(u,i)||(u[i]=!0,o(e,t,n))}};return Promise.all([e.or._iterate(r,t),sn(an(e,n,t),e.algorithm,r,!e.keysOnly&&e.valueMapper)])}return sn(an(e,n,t),Ht(e.algorithm,a),o,!e.keysOnly&&e.valueMapper)}function sn(e,r,i,o){var a=vt(o?function(e,t,n){return i(o(e),t,n)}:i);return e.then(function(n){if(n)return n.start(function(){var t=function(){return n.continue()};r&&!r(n,function(e){return t=e},function(e){n.stop(e),t=Ee},function(e){n.fail(e),t=Ee})||a(n.value,n,function(e){return t=e}),t()})})}var cn=(ln.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,Dt.bind(null,n.error)):n.table._trans("readonly",e).then(t)},ln.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Dt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},ln.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Ht(t.algorithm,e)},ln.prototype._iterate=function(e,t){return un(this._ctx,e,t,this._ctx.table.core)},ln.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&c(n,e),t._ctx=n,t},ln.prototype.raw=function(){return this._ctx.valueMapper=null,this},ln.prototype.each=function(t){var n=this._ctx;return this._read(function(e){return un(n,t,e,n.table.core)})},ln.prototype.count=function(e){var i=this;return this._read(function(e){var t=i._ctx,n=t.table.core;if(tn(t,!0))return n.count({trans:e,query:{index:on(t,n.schema),range:t.range}}).then(function(e){return Math.min(e,t.limit)});var r=0;return un(t,function(){return++r,!1},e,n).then(function(){return r})}).then(e)},ln.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var a="next"===this._ctx.dir?1:-1;function u(e,t){var n=o(e,i),r=o(t,i);return n<r?-a:r<n?a:0}return this.toArray(function(e){return e.sort(u)}).then(t)},ln.prototype.toArray=function(e){var o=this;return this._read(function(e){var t=o._ctx;if("next"===t.dir&&tn(t,!0)&&0<t.limit){var n=t.valueMapper,r=on(t,t.table.core.schema);return t.table.core.query({trans:e,limit:t.limit,values:!0,query:{index:r,range:t.range}}).then(function(e){var t=e.result;return n?t.map(n):t})}var i=[];return un(t,function(e){return i.push(e)},e,t.table.core).then(function(){return i})},e)},ln.prototype.offset=function(t){var e=this._ctx;return t<=0||(e.offset+=t,tn(e)?rn(e,function(){var n=t;return function(e,t){return 0===n||(1===n?--n:t(function(){e.advance(n),n=0}),!1)}}):rn(e,function(){var e=t;return function(){return--e<0}})),this},ln.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),rn(this._ctx,function(){var r=e;return function(e,t,n){return--r<=0&&t(n),0<=r}},!0),this},ln.prototype.until=function(r,i){return nn(this._ctx,function(e,t,n){return!r(e.value)||(t(n),i)}),this},ln.prototype.first=function(e){return this.limit(1).toArray(function(e){return e[0]}).then(e)},ln.prototype.last=function(e){return this.reverse().first(e)},ln.prototype.filter=function(t){return nn(this._ctx,function(e){return t(e.value)}),function(e,t){e.isMatch=Ht(e.isMatch,t)}(this._ctx,t),this},ln.prototype.and=function(e){return this.filter(e)},ln.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},ln.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ln.prototype.desc=function(){return this.reverse()},ln.prototype.eachKey=function(n){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(e,t){n(t.key,t)})},ln.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},ln.prototype.eachPrimaryKey=function(n){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(e,t){n(t.primaryKey,t)})},ln.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.key)}).then(function(){return n}).then(e)},ln.prototype.primaryKeys=function(e){var n=this._ctx;if("next"===n.dir&&tn(n,!0)&&0<n.limit)return this._read(function(e){var t=on(n,n.table.core.schema);return n.table.core.query({trans:e,values:!1,limit:n.limit,query:{index:t,range:n.range}})}).then(function(e){return e.result}).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(e,t){r.push(t.primaryKey)}).then(function(){return r}).then(e)},ln.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},ln.prototype.firstKey=function(e){return this.limit(1).keys(function(e){return e[0]}).then(e)},ln.prototype.lastKey=function(e){return this.reverse().firstKey(e)},ln.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var r={};return nn(this._ctx,function(e){var t=e.primaryKey.toString(),n=S(r,t);return r[t]=!0,!n}),this},ln.prototype.modify=function(c){var n=this,r=this._ctx;return this._write(function(h){var p;if("function"==typeof c)p=c;else{var o=j(c),a=o.length;p=function(e){for(var t=!1,n=0;n<a;++n){var r=o[n],i=c[r];L(e,r)!==i&&(z(e,r,i),t=!0)}return t}}function d(e,t){var n=t.failures,r=t.numFailures;s+=e-r;for(var i=0,o=j(n);i<o.length;i++){var a=o[i];u.push(n[a])}}var y=r.table.core,e=y.schema.primaryKey,v=e.outbound,m=e.extractKey,g="testmode"in nr?1:2e3,b=n.db.core.cmp,u=[],s=0,t=[];return n.clone().primaryKeys().then(function(l){var f=function(s){var c=Math.min(g,l.length-s);return y.getMany({trans:h,keys:l.slice(s,s+c)}).then(function(e){for(var n=[],t=[],r=v?[]:null,i=[],o=0;o<c;++o){var a=e[o],u={value:X(a),primKey:l[s+o]};!1!==p.call(u,u.value,u)&&(null==u.value?i.push(l[s+o]):v||0===b(m(a),m(u.value))?(t.push(u.value),v&&r.push(l[s+o])):(i.push(l[s+o]),n.push(u.value)))}return Promise.resolve(0<n.length&&y.mutate({trans:h,type:"add",values:n}).then(function(e){for(var t in e.failures)i.splice(parseInt(t),1);d(n.length,e)})).then(function(e){return 0<t.length&&y.mutate({trans:h,type:"put",keys:r,values:t}).then(function(e){return d(t.length,e)})}).then(function(){return 0<i.length&&y.mutate({trans:h,type:"delete",keys:i}).then(function(e){return d(i.length,e)})}).then(function(){return l.length>s+c&&f(s+g)})})};return f(0).then(function(){if(0<u.length)throw new me("Error modifying one or more objects",u,s,t);return l.length})})})},ln.prototype.delete=function(){var i=this._ctx,r=i.range;return tn(i)&&(i.isPrimKey&&!Vt||3===r.type)?this._write(function(e){var t=i.table.core.schema.primaryKey,n=r;return i.table.core.count({trans:e,query:{index:t,range:n}}).then(function(r){return i.table.core.mutate({trans:e,type:"deleteRange",range:n}).then(function(e){var t=e.failures,n=(e.lastResult,e.results,e.numFailures);if(n)throw new me("Could not delete some values",Object.keys(t).map(function(e){return t[e]}),r-n);return r-n})})}):this.modify(function(e,t){return t.value=null})},ln);function ln(){}function fn(e,t){return e<t?-1:e===t?0:1}function hn(e,t){return t<e?-1:e===t?0:1}function pn(e,t,n){var r=e instanceof bn?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function dn(e){return new e.Collection(e,function(){return gn("")}).limit(0)}function yn(e,t,n,r,i,o){for(var a=Math.min(e.length,r.length),u=-1,s=0;s<a;++s){var c=t[s];if(c!==r[s])return i(e[s],n[s])<0?e.substr(0,s)+n[s]+n.substr(s+1):i(e[s],r[s])<0?e.substr(0,s)+r[s]+n.substr(s+1):0<=u?e.substr(0,u)+t[u]+n.substr(u+1):null;i(e[s],c)<0&&(u=s)}return a<r.length&&"next"===o?e+n.substr(e.length):a<e.length&&"prev"===o?e.substr(0,n.length):u<0?null:e.substr(0,u)+r[u]+n.substr(u+1)}function vn(e,s,n,r){var i,c,l,f,h,p,d,y=n.length;if(!n.every(function(e){return"string"==typeof e}))return pn(e,Mt);function t(e){i=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),c=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),l="next"===e?fn:hn;var t=n.map(function(e){return{lower:c(e),upper:i(e)}}).sort(function(e,t){return l(e.lower,t.lower)});f=t.map(function(e){return e.upper}),h=t.map(function(e){return e.lower}),d="next"===(p=e)?"":r}t("next");var o=new e.Collection(e,function(){return mn(f[0],h[y-1]+r)});o._ondirectionchange=function(e){t(e)};var v=0;return o._addAlgorithm(function(e,t,n){var r=e.key;if("string"!=typeof r)return!1;var i=c(r);if(s(i,h,v))return!0;for(var o=null,a=v;a<y;++a){var u=yn(r,i,f[a],h[a],l,p);null===u&&null===o?v=a+1:(null===o||0<l(o,u))&&(o=u)}return t(null!==o?function(){e.continue(o+d)}:n),!1}),o}function mn(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function gn(e){return{type:1,lower:e,upper:e}}var bn=(Object.defineProperty(wn.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0}),wn.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return 0<this._cmp(e,t)||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?dn(this):new this.Collection(this,function(){return mn(e,t,!n,!r)})}catch(e){return pn(this,qt)}},wn.prototype.equals=function(e){return null==e?pn(this,qt):new this.Collection(this,function(){return gn(e)})},wn.prototype.above=function(e){return null==e?pn(this,qt):new this.Collection(this,function(){return mn(e,void 0,!0)})},wn.prototype.aboveOrEqual=function(e){return null==e?pn(this,qt):new this.Collection(this,function(){return mn(e,void 0,!1)})},wn.prototype.below=function(e){return null==e?pn(this,qt):new this.Collection(this,function(){return mn(void 0,e,!1,!0)})},wn.prototype.belowOrEqual=function(e){return null==e?pn(this,qt):new this.Collection(this,function(){return mn(void 0,e)})},wn.prototype.startsWith=function(e){return"string"!=typeof e?pn(this,Mt):this.between(e,e+Nt,!0,!0)},wn.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):vn(this,function(e,t){return 0===e.indexOf(t[0])},[e],Nt)},wn.prototype.equalsIgnoreCase=function(e){return vn(this,function(e,t){return e===t[0]},[e],"")},wn.prototype.anyOfIgnoreCase=function(){var e=ie.apply(re,arguments);return 0===e.length?dn(this):vn(this,function(e,t){return-1!==t.indexOf(e)},e,"")},wn.prototype.startsWithAnyOfIgnoreCase=function(){var e=ie.apply(re,arguments);return 0===e.length?dn(this):vn(this,function(t,e){return e.some(function(e){return 0===t.indexOf(e)})},e,Nt)},wn.prototype.anyOf=function(){var t=this,i=ie.apply(re,arguments),o=this._cmp;try{i.sort(o)}catch(e){return pn(this,qt)}if(0===i.length)return dn(this);var e=new this.Collection(this,function(){return mn(i[0],i[i.length-1])});e._ondirectionchange=function(e){o="next"===e?t._ascending:t._descending,i.sort(o)};var a=0;return e._addAlgorithm(function(e,t,n){for(var r=e.key;0<o(r,i[a]);)if(++a===i.length)return t(n),!1;return 0===o(r,i[a])||(t(function(){e.continue(i[a])}),!1)}),e},wn.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},wn.prototype.noneOf=function(){var e=ie.apply(re,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return pn(this,qt)}var t=e.reduce(function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},wn.prototype.inAnyRange=function(e,t){var i=this,o=this._cmp,a=this._ascending,n=this._descending,u=this._min,s=this._max;if(0===e.length)return dn(this);if(!e.every(function(e){return void 0!==e[0]&&void 0!==e[1]&&a(e[0],e[1])<=0}))return pn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",_e.InvalidArgument);var c,r=!t||!1!==t.includeLowers,l=t&&!0===t.includeUppers,f=a;function h(e,t){return f(e[0],t[0])}try{(c=e.reduce(function(e,t){for(var n=0,r=e.length;n<r;++n){var i=e[n];if(o(t[0],i[1])<0&&0<o(t[1],i[0])){i[0]=u(i[0],t[0]),i[1]=s(i[1],t[1]);break}}return n===r&&e.push(t),e},[])).sort(h)}catch(e){return pn(this,qt)}var p=0,d=l?function(e){return 0<a(e,c[p][1])}:function(e){return 0<=a(e,c[p][1])},y=r?function(e){return 0<n(e,c[p][0])}:function(e){return 0<=n(e,c[p][0])},v=d,m=new this.Collection(this,function(){return mn(c[0][0],c[c.length-1][1],!r,!l)});return m._ondirectionchange=function(e){f="next"===e?(v=d,a):(v=y,n),c.sort(h)},m._addAlgorithm(function(e,t,n){for(var r=e.key;v(r);)if(++p===c.length)return t(n),!1;return!!function(e){return!d(e)&&!y(e)}(r)||(0===i._cmp(r,c[p][1])||0===i._cmp(r,c[p][0])||t(function(){f===a?e.continue(c[p][0]):e.continue(c[p][1])}),!1)}),m},wn.prototype.startsWithAnyOf=function(){var e=ie.apply(re,arguments);return e.every(function(e){return"string"==typeof e})?0===e.length?dn(this):this.inAnyRange(e.map(function(e){return[e,e+Nt]})):pn(this,"startsWithAnyOf() only works with strings")},wn);function wn(){}function _n(e){return 1===e.length?e[0]:e}function xn(e){try{return e.only([[]]),[[]]}catch(e){return Nt}}function kn(t){return vt(function(e){return En(e),t(e.target.error),!1})}function En(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var On=(Pn.prototype._lock=function(){return N(!Ze.global),++this._reculock,1!==this._reculock||Ze.global||(Ze.lockOwnerFor=this),this},Pn.prototype._unlock=function(){if(N(!Ze.global),0==--this._reculock)for(Ze.global||(Ze.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Kt(e[1],e[0])}catch(e){}}return this},Pn.prototype._locked=function(){return this._reculock&&Ze.lockOwnerFor!==this},Pn.prototype.create=function(t){var n=this;if(!this.mode)return this;var e=this.db.idbdb,r=this.db._state.dbOpenError;if(N(!this.idbtrans),!t&&!e)switch(r&&r.name){case"DatabaseClosedError":throw new _e.DatabaseClosed(r);case"MissingAPIError":throw new _e.MissingAPI(r.message,r);default:throw new _e.OpenFailed(r)}if(!this.active)throw new _e.TransactionInactive;return N(null===this._completion._state),(t=this.idbtrans=t||e.transaction(_n(this.storeNames),this.mode)).onerror=vt(function(e){En(e),n._reject(t.error)}),t.onabort=vt(function(e){En(e),n.active&&n._reject(new _e.Abort(t.error)),n.active=!1,n.on("abort").fire(e)}),t.oncomplete=vt(function(){n.active=!1,n._resolve()}),this},Pn.prototype._promise=function(n,r,i){var o=this;if("readwrite"===n&&"readwrite"!==this.mode)return Dt(new _e.ReadOnly("Transaction is readonly"));if(!this.active)return Dt(new _e.TransactionInactive);if(this._locked())return new rt(function(e,t){o._blockedFuncs.push([function(){o._promise(n,r,i).then(e,t)},Ze])});if(i)return kt(function(){var e=new rt(function(e,t){o._lock();var n=r(e,t,o);n&&n.then&&n.then(e,t)});return e.finally(function(){return o._unlock()}),e._lib=!0,e});var e=new rt(function(e,t){var n=r(e,t,o);n&&n.then&&n.then(e,t)});return e._lib=!0,e},Pn.prototype._root=function(){return this.parent?this.parent._root():this},Pn.prototype.waitFor=function(e){var r=this._root(),i=rt.resolve(e);if(r._waitingFor)r._waitingFor=r._waitingFor.then(function(){return i});else{r._waitingFor=i,r._waitingQueue=[];var t=r.idbtrans.objectStore(r.storeNames[0]);!function e(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(t.get(-1/0).onsuccess=e)}()}var o=r._waitingFor;return new rt(function(t,n){i.then(function(e){return r._waitingQueue.push(vt(t.bind(null,e)))},function(e){return r._waitingQueue.push(vt(n.bind(null,e)))}).finally(function(){r._waitingFor===o&&(r._waitingFor=null)})})},Pn.prototype.abort=function(){this.active&&this._reject(new _e.Abort),this.active=!1},Pn.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(S(t,e))return t[e];var n=this.schema[e];if(!n)throw new _e.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r},Pn);function Pn(){}function jn(e,t,n,r,i,o,a){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!a?"&":"")+(r?"*":"")+(i?"++":"")+Sn(t)}}function Sn(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function An(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:M(n,function(e){return[e.name,e]})}}function Kn(t){return null==t?function(){}:"string"==typeof t?function(t){return 1===t.split(".").length?function(e){return e[t]}:function(e){return L(e,t)}}(t):function(e){return L(e,t)}}function In(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}function Cn(e){return[].slice.call(e)}var Rn=0;function Bn(e){return null==e?":id":"string"==typeof e?e:"["+e.join("+")+"]"}function Tn(e,t,o,n){var r=t.cmp.bind(t);function O(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var t=e.lower,n=e.upper,r=e.lowerOpen,i=e.upperOpen;return void 0===t?void 0===n?null:o.upperBound(n,!!i):void 0===n?o.lowerBound(t,!!r):o.bound(t,n,!!r,!!i)}var i,a,u,s=(a=n,u=Cn((i=e).objectStoreNames),{schema:{name:i.name,tables:u.map(function(e){return a.objectStore(e)}).map(function(t){var e=t.keyPath,n=t.autoIncrement,r=p(e),i=null==e,a={},o={name:t.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:e,autoIncrement:n,unique:!0,extractKey:Kn(e)},indexes:Cn(t.indexNames).map(function(e){return t.index(e)}).map(function(e){var t=e.name,n=e.unique,r=e.multiEntry,i=e.keyPath,o={name:t,compound:p(i),keyPath:i,unique:n,multiEntry:r,extractKey:Kn(i)};return a[Bn(i)]=o}),getIndexByKeyPath:function(e){return a[Bn(e)]}};return a[":id"]=o.primaryKey,null!=e&&(a[Bn(e)]=o.primaryKey),o})},hasGetAll:0<u.length&&"getAll"in a.objectStore(u[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),c=s.schema,l=s.hasGetAll,f=c.tables.map(function(e){return function(k){var m,E=k.name;return{name:E,schema:k,mutate:function(e){var m=e.trans,g=e.type,b=e.keys,w=e.values,_=e.range,x=e.wantResults;return new Promise(function(n,e){n=vt(n);var t=m.objectStore(E),r=null==t.keyPath,i="put"===g||"add"===g;if(!i&&"delete"!==g&&"deleteRange"!==g)throw new Error("Invalid operation type: "+g);var o=(b||w||{length:1}).length;if(b&&w&&b.length!==w.length)throw new Error("Given keys array must have same length as given values array.");if(0===o)return n({numFailures:0,failures:{},results:[],lastResult:void 0});function a(e){++f,En(e),c&&(c[e.target._reqno]=void 0),l[e.target._reqno]=e.target.error}function u(e){var t=e.target;c[t._reqno]=t.result}var s,c=x&&P(b||In(k.primaryKey,{type:g,keys:b,values:w})),l=[],f=0;if("deleteRange"===g){if(4===_.type)return n({numFailures:f,failures:l,results:c,lastResult:void 0});s=3===_.type?t.clear():t.delete(O(_))}else{var h=i?r?[w,b]:[w,null]:[b,null],p=h[0],d=h[1];if(i)for(var y=0;y<o;++y)(s=d&&void 0!==d[y]?t[g](p[y],d[y]):t[g](p[y]))._reqno=y,c&&void 0===c[y]&&(s.onsuccess=u),s.onerror=a;else for(y=0;y<o;++y)(s=t[g](p[y]))._reqno=y,s.onerror=a}function v(e){var t=e.target.result;c&&(c[o-1]=t),n({numFailures:f,failures:l,results:c,lastResult:t})}s.onerror=function(e){a(e),v(e)},s.onsuccess=v})},getMany:function(e){var f=e.trans,h=e.keys;return new Promise(function(n,e){n=vt(n);for(var t,r=f.objectStore(E),i=h.length,o=new Array(i),a=0,u=0,s=function(e){var t=e.target;null!=(o[t._pos]=t.result)&&0,++u===a&&n(o)},c=kn(e),l=0;l<i;++l){null!=h[l]&&((t=r.get(h[l]))._pos=l,t.onsuccess=s,t.onerror=c,++a)}0===a&&n(o)})},get:function(e){var r=e.trans,i=e.key;return new Promise(function(t,e){t=vt(t);var n=r.objectStore(E).get(i);n.onsuccess=function(e){return t(e.target.result)},n.onerror=kn(e)})},query:(m=l,function(v){return new Promise(function(n,e){n=vt(n);var t=v.trans,r=v.values,i=v.limit,o=v.query,a=i===1/0?void 0:i,u=o.index,s=o.range,c=t.objectStore(E),l=u.isPrimaryKey?c:c.index(u.name),f=O(s);if(0===i)return n({result:[]});if(m){var h=r?l.getAll(f,a):l.getAllKeys(f,a);h.onsuccess=function(e){return n({result:e.target.result})},h.onerror=kn(e)}else{var p=0,d=!r&&"openKeyCursor"in l?l.openKeyCursor(f):l.openCursor(f),y=[];d.onsuccess=function(e){var t=d.result;return t?(y.push(r?t.value:t.primaryKey),++p===i?n({result:y}):void t.continue()):n({result:y})},d.onerror=kn(e)}})}),openCursor:function(e){var c=e.trans,u=e.values,l=e.query,f=e.reverse,h=e.unique;return new Promise(function(t,n){t=vt(t);var e=l.index,r=l.range,i=c.objectStore(E),o=e.isPrimaryKey?i:i.index(e.name),a=f?h?"prevunique":"prev":h?"nextunique":"next",s=!u&&"openKeyCursor"in o?o.openKeyCursor(O(r),a):o.openCursor(O(r),a);s.onerror=kn(n),s.onsuccess=vt(function(e){var r=s.result;if(r){r.___id=++Rn,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o=o&&o.bind(r);var a=r.advance.bind(r),u=function(){throw new Error("Cursor not stopped")};r.trans=c,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=vt(n),r.next=function(){var e=this,t=1;return this.start(function(){return t--?e.continue():e.stop()}).then(function(){return e})},r.start=function(e){function t(){if(s.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()}var n=new Promise(function(t,e){t=vt(t),s.onerror=kn(e),r.fail=e,r.stop=function(e){r.stop=r.continue=r.continuePrimaryKey=r.advance=u,t(e)}});return s.onsuccess=vt(function(e){(s.onsuccess=t)()}),r.continue=i,r.continuePrimaryKey=o,r.advance=a,t(),n},t(r)}else t(null)},n)})},count:function(e){var t=e.query,a=e.trans,u=t.index,s=t.range;return new Promise(function(t,e){var n=a.objectStore(E),r=u.isPrimaryKey?n:n.index(u.name),i=O(s),o=i?r.count(i):r.count();o.onsuccess=vt(function(e){return t(e.target.result)}),o.onerror=kn(e)})}}}(e)}),h={};return f.forEach(function(e){return h[e.name]=e}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!h[e])throw new Error("Table '"+e+"' not found");return h[e]},cmp:r,MIN_KEY:-1/0,MAX_KEY:xn(o),schema:c}}function Dn(e,t,n,r){var i=n.IDBKeyRange;return{dbcore:function(e,t){return t.reduce(function(e,t){var n=t.create;return O(O({},e),n(e))},e)}(Tn(t,n.indexedDB,i,r),e.dbcore)}}function Fn(n,e){var t=e.db,r=Dn(n._middlewares,t,n._deps,e);n.core=r.dbcore,n.tables.forEach(function(e){var t=e.name;n.core.schema.tables.some(function(e){return e.name===t})&&(e.core=n.core.table(t),n[t]instanceof n.Table&&(n[t].core=e.core))})}function Nn(i,e,t,o){t.forEach(function(n){var r=o[n];e.forEach(function(e){var t=B(e,n);(!t||"value"in t&&void 0===t.value)&&(e===i.Transaction.prototype||e instanceof i.Transaction?I(e,n,{get:function(){return this.table(n)},set:function(e){K(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):e[n]=new i.Table(n,r))})})}function qn(n,e){e.forEach(function(e){for(var t in e)e[t]instanceof n.Table&&delete e[t]})}function Mn(e,t){return e._cfg.version-t._cfg.version}function Ln(e,t,n,r){var i=e._dbSchema,o=e._createTransaction("readwrite",e._storeNames,i);o.create(n),o._completion.catch(r);var a=o._reject.bind(o),u=Ze.transless||Ze;kt(function(){Ze.trans=o,Ze.transless=u,0===t?(j(i).forEach(function(e){Un(n,e,i[e].primKey,i[e].indexes)}),Fn(e,n),rt.follow(function(){return e.on.populate.fire(o)}).catch(a)):function(c,l,f,h){var t=[],e=c._versions,p=c._dbSchema=Gn(c,c.idbdb,h),d=!1;return e.filter(function(e){return e._cfg.version>=l}).forEach(function(s){t.push(function(){var t=p,e=s._cfg.dbschema;Wn(c,t,h),Wn(c,e,h),p=c._dbSchema=e;var n=zn(t,e);n.add.forEach(function(e){Un(h,e[0],e[1].primKey,e[1].indexes)}),n.change.forEach(function(e){if(e.recreate)throw new _e.Upgrade("Not yet support for changing primary key");var t=h.objectStore(e.name);e.add.forEach(function(e){return Vn(t,e)}),e.change.forEach(function(e){t.deleteIndex(e.name),Vn(t,e)}),e.del.forEach(function(e){return t.deleteIndex(e)})});var r=s._cfg.contentUpgrade;if(r&&s._cfg.version>l){Fn(c,h),f._memoizedTables={},d=!0;var i=V(e);n.del.forEach(function(e){i[e]=t[e]}),qn(c,[c.Transaction.prototype]),Nn(c,[c.Transaction.prototype],j(i),i),f.schema=i;var o,a=oe(r);a&&Et();var u=rt.follow(function(){if((o=r(f))&&a){var e=Ot.bind(null,null);o.then(e,e)}});return o&&"function"==typeof o.then?rt.resolve(o):u.then(function(){return o})}}),t.push(function(e){d&&Ut||function(e,t){for(var n=0;n<t.db.objectStoreNames.length;++n){var r=t.db.objectStoreNames[n];null==e[r]&&t.db.deleteObjectStore(r)}}(s._cfg.dbschema,e);qn(c,[c.Transaction.prototype]),Nn(c,[c.Transaction.prototype],c._storeNames,c._dbSchema),f.schema=c._dbSchema})}),function e(){return t.length?rt.resolve(t.shift()(f.idbtrans)).then(e):rt.resolve()}().then(function(){!function(t,n){j(t).forEach(function(e){n.db.objectStoreNames.contains(e)||Un(n,e,t[e].primKey,t[e].indexes)})}(p,h)})}(e,t,o,n).catch(a)})}function zn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],o=t[n];if(i){var a={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!zt)a.recreate=!0,r.change.push(a);else{var u=i.idxByName,s=o.idxByName,c=void 0;for(c in u)s[c]||a.del.push(c);for(c in s){var l=u[c],f=s[c];l?l.src!==f.src&&a.change.push(f):a.add.push(f)}(0<a.del.length||0<a.add.length||0<a.change.length)&&r.change.push(a)}}else r.add.push([n,o])}return r}function Un(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(e){return Vn(i,e)}),i}function Vn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Gn(e,t,s){var c={};return D(t.objectStoreNames,0).forEach(function(e){for(var t=s.objectStore(e),n=t.keyPath,r=jn(Sn(n),n||"",!1,!1,!!t.autoIncrement,n&&"string"!=typeof n,!0),i=[],o=0;o<t.indexNames.length;++o){var a=t.index(t.indexNames[o]);n=a.keyPath;var u=jn(a.name,n,!!a.unique,!!a.multiEntry,!1,n&&"string"!=typeof n,!1);i.push(u)}c[e]=An(e,r,i)}),c}function Wn(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var o=r[i],a=n.objectStore(o);e._hasGetAll="getAll"in a;for(var u=0;u<a.indexNames.length;++u){var s=a.indexNames[u],c=a.index(s).keyPath,l="string"==typeof c?c:"["+D(c).join("+")+"]";if(t[o]){var f=t[o].idxByName[l];f&&(f.name=s,delete t[o].idxByName[l],t[o].idxByName[s]=f)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&h.WorkerGlobalScope&&h instanceof h.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}var Yn,Hn=(Qn.prototype._parseStoresSpec=function(r,i){j(r).forEach(function(e){if(null!==r[e]){var t=function(e){return e.split(",").map(function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return jn(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),p(r),0===t)})}(r[e]),n=t.shift();if(n.multi)throw new _e.Schema("Primary key cannot be multi-valued");t.forEach(function(e){if(e.auto)throw new _e.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new _e.Schema("Index must have a name and cannot be an empty string")}),i[e]=An(e,n,t)}})},Qn.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,e):e;var n=t._versions,r={},i={};return n.forEach(function(e){c(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)}),t._dbSchema=i,qn(t,[t._allTables,t,t.Transaction.prototype]),Nn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],j(i),i),t._storeNames=j(i),this},Qn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=e,this},Qn);function Qn(){}function Xn(e){return kt(function(){return Ze.letThrough=!0,e()})}function $n(u){var s=u._state,c=u._deps.indexedDB;if(s.isBeingOpened||u.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?Dt(s.dbOpenError):u});ae&&(s.openCanceller._stackHolder=le()),s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var e=s.dbReadyResolve,l=null;return rt.race([s.openCanceller,new rt(function(r,i){if(!c)throw new _e.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var o=u.name,a=s.autoSchema?c.open(o):c.open(o,Math.round(10*u.verno));if(!a)throw new _e.MissingAPI("IndexedDB API not available");a.onerror=kn(i),a.onblocked=vt(u._fireOnBlocked),a.onupgradeneeded=vt(function(e){if(l=a.transaction,s.autoSchema&&!u._options.allowEmptyDB){a.onerror=En,l.abort(),a.result.close();var t=c.deleteDatabase(o);t.onsuccess=t.onerror=vt(function(){i(new _e.NoSuchDatabase("Database "+o+" doesnt exist"))})}else{l.onerror=kn(i);var n=e.oldVersion>Math.pow(2,62)?0:e.oldVersion;u.idbdb=a.result,Ln(u,n/10,l,i)}},i),a.onsuccess=vt(function(){l=null;var e=u.idbdb=a.result,t=D(e.objectStoreNames);if(0<t.length)try{var n=e.transaction(_n(t),"readonly");s.autoSchema?function(e,t,n){e.verno=t.version/10;var r=e._dbSchema=Gn(0,t,n);e._storeNames=D(t.objectStoreNames,0),Nn(e,[e._allTables],j(r),r)}(u,e,n):(Wn(u,u._dbSchema,n),function(e,t){var n=zn(Gn(0,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some(function(e){return e.add.length||e.change.length}))}(u,n)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Fn(u,n)}catch(e){}Lt.push(u),e.onversionchange=vt(function(e){s.vcFired=!0,u.on("versionchange").fire(e)}),Yn.add(o),r()},i)})]).then(function(){return s.onReadyBeingFired=[],rt.resolve(Xn(u.on.ready.fire)).then(function e(){if(0<s.onReadyBeingFired.length){var t=s.onReadyBeingFired.reduce(Ce,Ee);return s.onReadyBeingFired=[],rt.resolve(Xn(t)).then(e)}})}).finally(function(){s.onReadyBeingFired=null}).then(function(){return s.isBeingOpened=!1,u}).catch(function(e){try{l&&l.abort()}catch(e){}return s.isBeingOpened=!1,u.close(),s.dbOpenError=e,Dt(s.dbOpenError)}).finally(function(){s.openComplete=!0,e()})}function Jn(t){function e(e){return t.next(e)}var i=n(e),o=n(function(e){return t.throw(e)});function n(r){return function(e){var t=r(e),n=t.value;return t.done?n:n&&"function"==typeof n.then?n.then(i,o):p(n)?Promise.all(n).then(i,o):i(n)}}return n(e)()}function Zn(e,t,n){for(var r=p(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}var er={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(f){return O(O({},f),{table:function(e){var o=f.table(e),t=o.schema,s={},c=[];function l(e,t,n){var r=Bn(e),i=s[r]=s[r]||[],o=null==e?0:"string"==typeof e?1:e.length,a=0<t,u=O(O({},n),{isVirtual:a,isPrimaryKey:!a&&n.isPrimaryKey,keyTail:t,keyLength:o,extractKey:Kn(e),unique:!a&&n.unique});i.push(u),u.isPrimaryKey||c.push(u),1<o&&l(2===o?e[0]:e.slice(0,o-1),t+1,n);return i.sort(function(e,t){return e.keyTail-t.keyTail}),u}var n=l(t.primaryKey.keyPath,0,t.primaryKey);s[":id"]=[n];for(var r=0,i=t.indexes;r<i.length;r++){var a=i[r];l(a.keyPath,0,a)}function u(e){var t=e.query.index;return t.isVirtual?O(O({},e),{query:{index:t,range:function(e,t){return{type:1===e.type?2:e.type,lower:Zn(e.lower,e.lowerOpen?f.MAX_KEY:f.MIN_KEY,t),lowerOpen:!0,upper:Zn(e.upper,e.upperOpen?f.MIN_KEY:f.MAX_KEY,t),upperOpen:!0}}(e.query.range,t.keyTail)}}):e}return O(O({},o),{schema:O(O({},t),{primaryKey:n,indexes:c,getIndexByKeyPath:function(e){var t=s[Bn(e)];return t&&t[0]}}),count:function(e){return o.count(u(e))},query:function(e){return o.query(u(e))},openCursor:function(t){var e=t.query.index,r=e.keyTail,n=e.isVirtual,i=e.keyLength;if(!n)return o.openCursor(t);return o.openCursor(u(t)).then(function(e){return e&&function(n){return Object.create(n,{continue:{value:function(e){null!=e?n.continue(Zn(e,t.reverse?f.MAX_KEY:f.MIN_KEY,r)):t.unique?n.continue(Zn(n.key,t.reverse?f.MIN_KEY:f.MAX_KEY,r)):n.continue()}},continuePrimaryKey:{value:function(e,t){n.continuePrimaryKey(Zn(e,f.MAX_KEY,r),t)}},key:{get:function(){var e=n.key;return 1===i?e[0]:e.slice(0,i)}},value:{get:function(){return n.value}}})}(e)})}})}})}},tr={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return O(O({},e),{table:function(r){var u=e.table(r),v=u.schema.primaryKey;return O(O({},u),{mutate:function(e){var t=Ze.trans,n=t.table(r).hook,p=n.deleting,d=n.creating,y=n.updating;switch(e.type){case"add":if(d.fire===Ee)break;return t._promise("readwrite",function(){return a(e)},!0);case"put":if(d.fire===Ee&&y.fire===Ee)break;return t._promise("readwrite",function(){return a(e)},!0);case"delete":if(p.fire===Ee)break;return t._promise("readwrite",function(){return a(e)},!0);case"deleteRange":if(p.fire===Ee)break;return t._promise("readwrite",function(){return function(e){return function n(r,i,o){return u.query({trans:r,values:!1,query:{index:v,range:i},limit:o}).then(function(e){var t=e.result;return a({type:"delete",keys:t,trans:r}).then(function(e){return 0<e.numFailures?Promise.reject(e.failures[0]):t.length<o?{failures:[],numFailures:0,lastResult:void 0}:n(r,O(O({},i),{lower:t[t.length-1],lowerOpen:!0}),o)})})}(e.trans,e.range,1e4)}(e)},!0)}return u.mutate(e);function a(l){var f=Ze.trans,h=l.keys||In(v,l);if(!h)throw new Error("Keys missing");return"delete"!==(l="add"===l.type||"put"===l.type?O(O({},l),{keys:h,wantResults:!0}):O({},l)).type&&(l.values=P(l.values)),l.keys&&(l.keys=P(l.keys)),function(e,t,n){return"add"===t.type?Promise.resolve(new Array(t.values.length)):e.getMany({trans:t.trans,keys:n})}(u,l,h).then(function(s){var c=h.map(function(e,t){var n=s[t],r={onerror:null,onsuccess:null};if("delete"===l.type)p.fire.call(r,e,n,f);else if("add"===l.type||void 0===n){var i=d.fire.call(r,e,l.values[t],f);null==e&&null!=i&&(e=i,l.keys[t]=e,v.outbound||z(l.values[t],v.keyPath,e))}else{var o=ee(n,l.values[t]),a=y.fire.call(r,o,e,n,f);if(a){var u=l.values[t];Object.keys(a).forEach(function(e){S(u,e)?u[e]=a[e]:z(u,e,a[e])})}}return r});return u.mutate(l).then(function(e){for(var t=e.failures,n=e.results,r=e.numFailures,i=e.lastResult,o=0;o<h.length;++o){var a=n?n[o]:h[o],u=c[o];null==a?u.onerror&&u.onerror(t[o]):u.onsuccess&&u.onsuccess("put"===l.type&&s[o]?l.values[o]:a)}return{failures:t,results:n,numFailures:r,lastResult:i}}).catch(function(t){return c.forEach(function(e){return e.onerror&&e.onerror(t)}),Promise.reject(t)})})}}})}})}},nr=(rr.prototype.version=function(t){if(isNaN(t)||t<.1)throw new _e.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new _e.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var e=this._versions,n=e.filter(function(e){return e._cfg.version===t})[0];return n||(n=new this.Version(t),e.push(n),e.sort(Mn),n.stores({}),this._state.autoSchema=!1,n)},rr.prototype._whenReady=function(e){var n=this;return this._state.openComplete||Ze.letThrough?e():new rt(function(e,t){if(!n._state.isBeingOpened){if(!n._options.autoOpen)return void t(new _e.DatabaseClosed);n.open().catch(Ee)}n._state.dbReadyPromise.then(e,t)}).then(e)},rr.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;i&&this.unuse({stack:t,name:i});var o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:n,level:null==r?10:r,name:i}),o.sort(function(e,t){return e.level-t.level}),this},rr.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(e){return r?e.create!==r:!!n&&e.name!==n})),this},rr.prototype.open=function(){return $n(this)},rr.prototype.close=function(){var e=Lt.indexOf(this),n=this._state;if(0<=e&&Lt.splice(e,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}this._options.autoOpen=!1,n.dbOpenError=new _e.DatabaseClosed,n.isBeingOpened&&n.cancelOpen(n.dbOpenError),n.dbReadyPromise=new rt(function(e){n.dbReadyResolve=e}),n.openCanceller=new rt(function(e,t){n.cancelOpen=t})},rr.prototype.delete=function(){var r=this,i=0<arguments.length,o=this._state;return new rt(function(t,n){function e(){r.close();var e=r._deps.indexedDB.deleteDatabase(r.name);e.onsuccess=vt(function(){Yn.remove(r.name),t()}),e.onerror=kn(n),e.onblocked=r._fireOnBlocked}if(i)throw new _e.InvalidArgument("Arguments not allowed in db.delete()");o.isBeingOpened?o.dbReadyPromise.then(e):e()})},rr.prototype.backendDB=function(){return this.idbdb},rr.prototype.isOpen=function(){return null!==this.idbdb},rr.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},rr.prototype.hasFailed=function(){return null!==this._state.dbOpenError},rr.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(rr.prototype,"tables",{get:function(){var t=this;return j(this._allTables).map(function(e){return t._allTables[e]})},enumerable:!0,configurable:!0}),rr.prototype.transaction=function(){var e=function(e,t,n){var r=arguments.length;if(r<2)throw new _e.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];return n=i.pop(),[e,W(i),n]}.apply(this,arguments);return this._transaction.apply(this,e)},rr.prototype._transaction=function(e,t,n){var r=this,i=Ze.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var o,a,u=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=t.map(function(e){var t=e instanceof r.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t}),"r"==e||e===Wt)o=Wt;else{if("rw"!=e&&e!=Yt)throw new _e.InvalidArgument("Invalid transaction mode: "+e);o=Yt}if(i){if(i.mode===Wt&&o===Yt){if(!u)throw new _e.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach(function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!u)throw new _e.SubTransaction("Table "+e+" not included in parent transaction.");i=null}}),u&&i&&!i.active&&(i=null)}}catch(n){return i?i._promise(null,function(e,t){t(n)}):Dt(n)}var s=function(a,u,s,c,l){return rt.resolve().then(function(){var e=Ze.transless||Ze,t=a._createTransaction(u,s,a._dbSchema,c),n={trans:t,transless:e};c?t.idbtrans=c.idbtrans:t.create();var r,i=oe(l);i&&Et();var o=rt.follow(function(){if(r=l.call(t,t))if(i){var e=Ot.bind(null,null);r.then(e,e)}else"function"==typeof r.next&&"function"==typeof r.throw&&(r=Jn(r))},n);return(r&&"function"==typeof r.then?rt.resolve(r).then(function(e){return t.active?e:Dt(new _e.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):o.then(function(){return r})).then(function(e){return c&&t._resolve(),t._completion.then(function(){return e})}).catch(function(e){return t._reject(e),Dt(e)})})}.bind(null,this,o,a,i,n);return i?i._promise(o,s,"lock"):Ze.trans?Kt(Ze.transless,function(){return r._whenReady(s)}):this._whenReady(s)},rr.prototype.table=function(e){if(!S(this._allTables,e))throw new _e.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},rr);function rr(e,t){var o=this;this._middlewares={},this.verno=0;var n=rr.dependencies;this._options=t=O({addons:rr.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange};var r=t.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={};var i={dbOpenError:this.idbdb=null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ee,dbReadyPromise:null,cancelOpen:Ee,openCanceller:null,autoSchema:!0};i.dbReadyPromise=new rt(function(e){i.dbReadyResolve=e}),i.openCanceller=new rt(function(e,t){i.cancelOpen=t}),this._state=i,this.name=e,this.on=Zt(this,"populate","blocked","versionchange",{ready:[Ce,Ee]}),this.on.ready.subscribe=F(this.on.ready.subscribe,function(i){return function(n,r){rr.vip(function(){var e=o._state;if(e.openComplete)e.dbOpenError||rt.resolve().then(n),r&&i(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),r&&i(n);else{i(n);var t=o;r||i(function e(){t.on.ready.unsubscribe(n),t.on.ready.unsubscribe(e)})}})}}),this.Collection=function(u){return en(cn.prototype,function(e,t){this.db=u;var n=Qt,r=null;if(t)try{n=t()}catch(e){r=e}var i=e._ctx,o=i.table,a=o.hook.reading.fire;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:a!==Oe?a:null}})}(this),this.Table=function(r){return en($t.prototype,function(e,t,n){this.db=r,this._tx=n,this.name=e,this.schema=t,this.hook=r._allTables[e]?r._allTables[e].hook:Zt(null,{creating:[Se,Ee],reading:[Pe,Oe],updating:[Ke,Ee],deleting:[Ae,Ee]})})}(this),this.Transaction=function(o){return en(On.prototype,function(e,t,n,r){var i=this;this.db=o,this.mode=e,this.storeNames=t,this.schema=n,this.idbtrans=null,this.on=Zt(this,"complete","error","abort"),this.parent=r||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new rt(function(e,t){i._resolve=e,i._reject=t}),this._completion.then(function(){i.active=!1,i.on.complete.fire()},function(e){var t=i.active;return i.active=!1,i.on.error.fire(e),i.parent?i.parent._reject(e):t&&i.idbtrans&&i.idbtrans.abort(),Dt(e)})})}(this),this.Version=function(t){return en(Hn.prototype,function(e){this.db=t,this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(i){return en(bn.prototype,function(e,t,n){this.db=i,this._ctx={table:e,index:":id"===t?null:t,or:n};var r=i._deps.indexedDB;if(!r)throw new _e.MissingAPI("indexedDB API missing");this._cmp=this._ascending=r.cmp.bind(r),this._descending=function(e,t){return r.cmp(t,e)},this._max=function(e,t){return 0<r.cmp(e,t)?e:t},this._min=function(e,t){return r.cmp(e,t)<0?e:t},this._IDBKeyRange=i._deps.IDBKeyRange})}(this),this.on("versionchange",function(e){0<e.newVersion?console.warn("Another connection wants to upgrade database '"+o.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+o.name+"'. Closing db now to resume the delete request."),o.close()}),this.on("blocked",function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+o.name+"') was blocked"):console.warn("Upgrade '"+o.name+"' blocked by other connection holding version "+e.oldVersion/10)}),this._maxKey=xn(t.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new o.Transaction(e,t,n,r)},this._fireOnBlocked=function(t){o.on("blocked").fire(t),Lt.filter(function(e){return e.name===o.name&&e!==o&&!e._state.vcFired}).map(function(e){return e.on("versionchange").fire(t)})},this.use(er),this.use(tr),r.forEach(function(e){return e(o)})}var ir=nr;A(ir,O(O({},ke),{delete:function(e){return new ir(e).delete()},exists:function(e){return new ir(e,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){return Yn?Yn.getDatabaseNames().then(e):rt.resolve([])},defineClass:function(){return function(e){c(this,e)}},ignoreTransaction:function(e){return Ze.trans?Kt(Ze.transless,e):e()},vip:Xn,async:function(t){return function(){try{var e=Jn(t.apply(this,arguments));return e&&"function"==typeof e.then?e:rt.resolve(e)}catch(e){return Dt(e)}}},spawn:function(e,t,n){try{var r=Jn(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:rt.resolve(r)}catch(e){return Dt(e)}},currentTransaction:{get:function(){return Ze.trans||null}},waitFor:function(e,t){var n=rt.resolve("function"==typeof e?ir.ignoreTransaction(e):e).timeout(t||6e4);return Ze.trans?Ze.trans.waitFor(n):n},Promise:rt,debug:{get:function(){return ae},set:function(e){ue(e,"dexie"===e?function(){return!0}:Ft)}},derive:C,extend:c,props:A,override:F,Events:Zt,getByKeyPath:L,setByKeyPath:z,delByKeyPath:U,shallowClone:V,deepClone:X,getObjectDiff:ee,asap:q,minKey:-1/0,addons:[],connections:Lt,errnames:be,dependencies:function(){try{return{indexedDB:h.indexedDB||h.mozIndexedDB||h.webkitIndexedDB||h.msIndexedDB,IDBKeyRange:h.IDBKeyRange||h.webkitIDBKeyRange}}catch(e){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"3.0.3",version:"3.0.3".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)}),default:ir,Dexie:ir})),ir.maxKey=xn(ir.dependencies.IDBKeyRange),function(e){try{Yn=function(e){var t,n=e&&"function"==typeof e.databases;if(!n){var r=new nr(Gt,{addons:[]});r.version(1).stores({dbnames:"name"}),t=r.table("dbnames")}return{getDatabaseNames:function(){return n?rt.resolve(e.databases()).then(function(e){return e.map(function(e){return e.name}).filter(function(e){return e!==Gt})}):t.toCollection().primaryKeys()},add:function(e){return!n&&e!==Gt&&t.put({name:e}).catch(Ee)},remove:function(e){return!n&&e!==Gt&&t.delete(e).catch(Ee)}}}(e)}catch(e){}}(nr.dependencies.indexedDB),rt.rejectionMapper=function(e,t){if(!e||e instanceof ye||e instanceof TypeError||e instanceof SyntaxError||!e.name||!xe[e.name])return e;var n=new xe[e.name](t||e.message,e);return"stack"in e&&I(n,"stack",{get:function(){return this.inner.stack}}),n},ue(ae,Ft);var or=nr,ar=function(){function e(){v(this,e)}return m(e,[{key:"create",value:function(e,t,n){throw new Error("not implemented")}},{key:"remove",value:function(e){throw new Error("not implemented")}},{key:"put",value:function(e,t,n){throw new Error("not implemented")}},{key:"get",value:function(e){throw new Error("not implemented")}},{key:"where",value:function(e){throw new Error("not implemented")}},{key:"isEmpty",value:function(e){throw new Error("not implemented")}}]),e}();function ur(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=a(r);if(i){var n=a(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return o(this,e)}}var sr=function(){l(i,ar);var t,n,r=ur(i);function i(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"default";return v(this,i),(e=r.call(this,t)).name="indexeddb",e.storage=new or(t),e.storage.version(1).stores({files:"path,node,parentId"}),e}return m(i,[{key:"create",value:function(e,t,n){return this.put(e,t,n)}},{key:"remove",value:(n=y(b().mark(function e(t){return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.files.where({path:t}).delete();case 2:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"put",value:function(e,t,n){return this.storage.files.put({path:e,node:t,parentId:n})}},{key:"transaction",value:function(e,t){return this.storage.transaction(e,this.storage.files,t)}},{key:"get",value:function(e){return this.storage.files.get({path:e})}},{key:"getBy",value:function(e,t){var n={};return n[e]=t,this.storage.files.where(n).toArray()}},{key:"where",value:function(e){return this.storage.files.where(e).toArray()}},{key:"isEmpty",value:(t=y(b().mark(function e(t){var n;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.files.where({parentId:t}).count();case 2:return n=e.sent,e.abrupt("return",0===n);case 4:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}]),i}();function cr(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return lr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function lr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fr(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=a(r);if(i){var n=a(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return o(this,e)}}var hr={FileSystem:function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};v(this,t),this.storage=e.storage||new sr(e&&e.name||"default")}var n,r,i,o,a,u,s,c,l,f,h,p,d;return m(t,[{key:"mkdir",value:(d=y(b().mark(function e(t){var n,r,i,o;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new w(t).normalize(),e.next=3,this.exists(t);case 3:if(n=e.sent)return e.abrupt("return",n.path);e.next=6;break;case 6:return e.next=8,this.exists(t.parent);case 8:if(r=e.sent,i=r?r.path:0,t.parent.isRoot||r){e.next=14;break}throw new Error("parent is not created yet");case 14:if(r&&r.node.mode!==_)throw new Error("parent is not dir");e.next=16;break;case 16:return o=new g(t.path,_,0),e.abrupt("return",this.storage.create(t.path,o,i));case 18:case"end":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)})},{key:"mkdirParents",value:(p=y(b().mark(function e(t){var n,r,i,o,a=arguments;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=1<a.length&&void 0!==a[1]?a[1]:"",t=new w(t).normalize(),r=t.path.split("/"),i=""===n?"/":"".concat(n,"/"),o=i+r.shift(),0===r.length)return e.abrupt("return",this.mkdir(o));e.next=7;break;case 7:return e.next=9,this.mkdir(o);case 9:return e.abrupt("return",this.mkdirParents(r.join("/"),o));case 10:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"rmdir",value:(h=y(b().mark(function e(t){var n,r;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new w(t).normalize(),e.next=3,this.exists(t);case 3:if(n=e.sent,r=!1,n){e.next=9;break}throw new Error("dir does not exists");case 9:if(n.node.mode===_)return e.next=12,this.storage.isEmpty(n.path);e.next=15;break;case 12:r=e.sent,e.next=16;break;case 15:throw new Error("it is not a dir");case 16:if(r)return e.next=19,this.storage.remove(t.path);e.next=21;break;case 19:e.next=22;break;case 21:throw new Error("dir is not empty");case 22:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"readFile",value:(f=y(b().mark(function e(t,n){var r;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new w(t).normalize(),e.next=3,this.storage.get(t.path);case 3:if(r=e.sent){e.next=6;break}throw new Error("File ".concat(t.path," does not exist"));case 6:return e.abrupt("return",r.node.data);case 7:case"end":return e.stop()}},e,this)})),function(e,t){return f.apply(this,arguments)})},{key:"writeFile",value:(l=y(b().mark(function e(t,n,r){var i,o,a;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new w(t).normalize(),n instanceof Blob){e.next=3;break}throw new Error("data must be instance of Blob");case 3:return e.next=5,this.exists(t.parent);case 5:if(i=e.sent){e.next=10;break}throw new Error("file needs parent");case 10:if(i&&i.node.mode!==_)throw new Error("parent should be dir");e.next=12;break;case 12:return o=i.path,a=new g(t.path,x,n.size,r,n),e.abrupt("return",this.storage.put(t.path,a,o));case 15:case"end":return e.stop()}},e,this)})),function(e,t,n){return l.apply(this,arguments)})},{key:"outputFile",value:(c=y(b().mark(function e(t,n,r){var i,o,a,u;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new w(t).normalize(),n instanceof Blob){e.next=3;break}throw new Error("data must be instance of Blob");case 3:return e.next=5,this.mkdirParents(t.parent);case 5:return i=e.sent,e.next=8,this.exists(i);case 8:if((o=e.sent)&&o.node.mode!==_)throw new Error("parent should be dir");e.next=11;break;case 11:return a=o.path,u=new g(t.path,x,n.size,r,n),e.abrupt("return",this.storage.put(t.path,u,a));case 14:case"end":return e.stop()}},e,this)})),function(e,t,n){return c.apply(this,arguments)})},{key:"bulkOutputFiles",value:(s=y(b().mark(function e(r){var i=this;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.storage.transaction("rw",y(b().mark(function e(){var t,n;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(t<r.length)return n=r[t],e.next=5,i.outputFile(n.path,n.blob,n.options||{});e.next=8;break;case 5:t++,e.next=1;break;case 8:case"end":return e.stop()}},e)}))));case 1:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"rename",value:(u=y(b().mark(function e(t,n){return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("not implemented");case 1:case"end":return e.stop()}},e)})),function(e,t){return u.apply(this,arguments)})},{key:"unlink",value:(a=y(b().mark(function e(t){var n;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new w(t).normalize(),e.next=3,this.exists(t);case 3:if(n=e.sent){e.next=8;break}throw new Error("file does not exists");case 8:if(n.node.mode===_)throw new Error("path points to a directory, please use rmdir");e.next=12;break;case 12:return e.abrupt("return",this.storage.remove(n.path));case 13:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"rmdirRecursive",value:(o=y(b().mark(function e(t){var n,r,i,o,a;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new w(t).normalize(),e.next=3,this.exists(t);case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return",!0);case 6:if(n.node.mode!==_)return e.abrupt("return",this.unlink(t));e.next=8;break;case 8:return e.next=10,this.ls(t);case 10:r=e.sent,i=cr(r),e.prev=12,i.s();case 14:if((o=i.n()).done){e.next=25;break}if((a=o.value).node.mode!==_)return e.next=19,this.unlink(a.path);e.next=21;break;case 19:e.next=23;break;case 21:return e.next=23,this.rmdirRecursive(a.path);case 23:e.next=14;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(12),i.e(e.t0);case 30:return e.prev=30,i.f(),e.finish(30);case 33:return e.abrupt("return",this.rmdir(t));case 34:case"end":return e.stop()}},e,this,[[12,27,30,33]])})),function(e){return o.apply(this,arguments)})},{key:"exists",value:(i=y(b().mark(function e(t){return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new w(t).normalize(),e.abrupt("return",this.storage.get(t.path));case 2:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"stats",value:(r=y(b().mark(function e(t){var n;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.exists(t);case 2:if(n=e.sent)return e.abrupt("return",new k(n.node,this.path));e.next=7;break;case 7:throw new Error("path does not exist");case 8:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"ls",value:(n=y(b().mark(function e(t){var n,r,i,o,a=arguments;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=1<a.length&&void 0!==a[1]?a[1]:{},r=Object.keys(n),e.next=4,this.exists(t);case 4:if(i=e.sent)return e.next=8,this.storage.where({parentId:i.path});e.next=11;break;case 8:return o=e.sent,0<r.length&&(o=o.filter(function(e){var t=new E(e.node,e.path);return r.some(function(e){return t[e]===n[e]})})),e.abrupt("return",o.map(function(e){return new E(e.node,e.path)}));case 11:throw new Error("path does not exist");case 12:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})}]),t}(),IndexedDbStorage:sr,MemoryStorage:function(){l(c,ar);var t,n,r,i,o,a,u,s=fr(c);function c(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"default";return v(this,c),(e=s.call(this,t)).name="memory",e.storage={files:{},transaction:function(e,t,n){return new Promise(function(e,t){e(n())})}},e.data={},e}return m(c,[{key:"create",value:(u=y(b().mark(function e(t,n,r){return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.data[t]={path:t,node:n,parentId:r},e.abrupt("return",t);case 2:case"end":return e.stop()}},e,this)})),function(e,t,n){return u.apply(this,arguments)})},{key:"remove",value:(a=y(b().mark(function e(t){return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t in this.data&&delete this.data[t],e.abrupt("return",void 0);case 2:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"put",value:(o=y(b().mark(function e(t,n,r){return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.create(t,n,r));case 1:case"end":return e.stop()}},e,this)})),function(e,t,n){return o.apply(this,arguments)})},{key:"transaction",value:(i=y(b().mark(function e(t,n){return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.storage.transaction(t,this.storage.files,n));case 1:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"get",value:(r=y(b().mark(function e(t){var n,r;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Object.keys(this.data),r=0;case 2:if(!(r<n.length)){e.next=8;break}if(this.data[n[r]].path===t)return e.abrupt("return",this.data[n[r]]);e.next=5;break;case 5:r++,e.next=2;break;case 8:return e.abrupt("return",void 0);case 9:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"where",value:(n=y(b().mark(function e(r){var i,o,a=this;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object.keys(r),o=[],Object.keys(this.data).forEach(function(e){var t=!0,n=a.data[e];i.forEach(function(e){n[e]!==r[e]&&(t=!1)}),t&&o.push(n)}),e.abrupt("return",o);case 4:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"isEmpty",value:(t=y(b().mark(function e(t){var n,r,i;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=0,r=Object.keys(this.data),i=0;i<r.length;i++)this.data[r[i]].parentId===t&&(n+=1);return e.abrupt("return",0===n);case 4:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}]),c}()}}(),dr=dr.default}()});
//# sourceMappingURL=SimpleFS.js.map